<!doctype html>
<html lang="en">

    <head>

		<!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <title>nidl</title>
        
        <!-- CSS -->
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500&display=swap">
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
        <link rel="stylesheet" href="../_static/css/jquery.mCustomScrollbar.min.css">
        <link rel="stylesheet" href="../_static/css/animate.css">
        <link rel="stylesheet" href="../_static/css/style.css">
        <link rel="stylesheet" href="../_static/css/jquery.mosaic.css">
        <link rel="stylesheet" href="../_static/sg_gallery.css">
        <link rel="stylesheet" href="../_static/css/media-queries.css">
        <link rel="stylesheet" href="../_static/css/pygment.css">

        <!-- Favicon and touch icons -->
        <link rel="shortcut icon" href="../_static/ico/favicon.png">
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../_static/ico/apple-touch-icon-144-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../_static/ico/apple-touch-icon-114-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../_static/ico/apple-touch-icon-72-precomposed.png">
        <link rel="apple-touch-icon-precomposed" href="../_static/ico/apple-touch-icon-57-precomposed.png">

    </head>

    <body>

		<!-- Wrapper -->
    	<div class="wrapper">

			<!-- Sidebar -->
			<nav class="sidebar">
				
				<!-- close sidebar menu -->
				<div class="dismiss">
					<i class="fas fa-arrow-left"></i>
				</div>
				
				<!-- <div class="logo"">
					<h3><a href="../index.html">Sidebar Menu</a></h3>
				</div> -->

                <!-- info setup -->
                    <p class="doc-version">
                        This documentation is for nidl <strong>version 0.0.0</strong>
                    </p>
                <p class="citing">
                    If you use the software, please do not hesitate to 
                    <a &mdash; <a href="https://github.com/neurospin-deepinsight/nidl">
                    Report a Bug</a>.
                </p>
				
                <!-- links -->
                
                
                    
                
				<ul class="list-unstyled menu-elements">
					<li class="active">
						<a href="../index.html"><i class="fas fa-home"></i> Home</a>
					</li>
					<li>
						<a href="installation.html"><i class="fas fa-cog"></i> Installation</a>
					</li>
					<li>
						<a href="../auto_gallery/index.html"><i class="fas fa-eye"></i> Gallery</a>
					</li>
					<li>
						<a href="documentation.html"><i class="fas fa-pencil-alt"></i> API documentation</a>
					</li>
					<li>
						<a href="search.html"><i class="fas fa-search"></i> Search</a>
					</li>
					<!-- <li>
						<a href="https://github.com/AGrigis/pysphinxdoc"><i class="fas fa-external-link-alt"></i> PYSPHINXDOC</a>
					</li> -->
					<!-- <li>
						<a href="#otherSections" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle" role="button" aria-controls="otherSections">
							<i class="fas fa-sync"></i>Sections Shortcuts
						</a>
						<ul class="collapse list-unstyled" id="otherSections">
                            <li>LINKS</li><li><a href='https://github.com/neurospin-deepinsight/surfify'>surfify</a></li>
                            
                                
                                
                                    
                                        
                                        
                                        
                                    
                                        
                                        
                                        
                                    
                                        
                                        
                                        
                                            
                                            
                                    
                                
                                    
                                        
                                        
                                        
                                    
                                        
                                        
                                        
                                            
                                            
                                    
                                
                                    
                                        
                                        
                                        
                                    
                                        
                                        
                                        
                                            
                                            
                                    
                                
                                    
                                        
                                        
                                        
                                    
                                        
                                        
                                        
                                            
                                            
                                    
                                
                                    
                                        
                                        
                                        
                                    
                                        
                                        
                                        
                                            
                                            
                                    
                                
                                    
                                        
                                        
                                        
                                    
                                        
                                        
                                        
                                            
                                            
                                    
                                
                                    
                                        
                                        
                                        
                                    
                                        
                                        
                                        
                                            
                                            
                                    
                                
                                    
                                        
                                        
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                    
                                        
                                        
                                        
                                            
                                            
                                    
                                
                                    
                                        
                                        
                                        
                                    
                                
                                
                                    <li>SECTIONS</li>
                                    
						                <li> <a href='#nidl.estimators.linear.LogisticRegression.configure_optimizers'>Logisticregression.configure_optimizers()</a> </li>                                    
                                    
						                <li> <a href='#nidl.estimators.linear.LogisticRegression.cross_entropy_loss'>Logisticregression.cross_entropy_loss()</a> </li>                                    
                                    
						                <li> <a href='#nidl.estimators.linear.LogisticRegression.freeze_encoder'>Logisticregression.freeze_encoder()</a> </li>                                    
                                    
						                <li> <a href='#nidl.estimators.linear.LogisticRegression.on_validation_epoch_end'>Logisticregression.on_validation_epoch_end()</a> </li>                                    
                                    
						                <li> <a href='#nidl.estimators.linear.LogisticRegression.predict_step'>Logisticregression.predict_step()</a> </li>                                    
                                    
						                <li> <a href='#nidl.estimators.linear.LogisticRegression.training_step'>Logisticregression.training_step()</a> </li>                                    
                                    
						                <li> <a href='#nidl.estimators.linear.LogisticRegression.validation_step'>Logisticregression.validation_step()</a> </li>                                    
                                    
						                <li> <a href='#examples'>Examples</a> </li>                                    
                                    
                                
                            
                            <li>API</li>
                            <li><a href="nidl.html">nidl</a></li><li><a href="nidl.callbacks.html">nidl.callbacks</a></li><li><a href="nidl.datasets.html">nidl.datasets</a></li><li><a href="nidl.estimators.html">nidl.estimators</a></li><li><a href="nidl.estimators.linear.html">nidl.estimators.linear</a></li><li><a href="nidl.estimators.ssl.html">nidl.estimators.ssl</a></li><li><a href="nidl.losses.html">nidl.losses</a></li><li><a href="nidl.transforms.html">nidl.transforms</a></li><li><a href="nidl.utils.html">nidl.utils</a></li><li><a href="nidl.volume.html">nidl.volume</a></li><li><a href="nidl.volume.backbones.html">nidl.volume.backbones</a></li><li><a href="surfify.html">surfify</a></li><li><a href="surfify.augmentation.html">surfify.augmentation</a></li><li><a href="surfify.datasets.html">surfify.datasets</a></li><li><a href="surfify.losses.html">surfify.losses</a></li><li><a href="surfify.models.html">surfify.models</a></li><li><a href="surfify.nn.html">surfify.nn</a></li><li><a href="surfify.plotting.html">surfify.plotting</a></li><li><a href="surfify.utils.html">surfify.utils</a></li>
						</ul>
					</li> -->
				</ul>
				
                <!-- go top page -->
				<!-- <div class="to-top">
					<a class="btn btn-primary btn-customized-3" href="#" role="button">
	                    <i class="fas fa-arrow-up"></i> Top
	                </a>
				</div> -->
			
                <!-- change color -->
				<!-- <div class="dark-light-buttons">
					<a class="btn btn-primary btn-customized-4 btn-customized-dark" href="#" role="button">Dark</a>
					<a class="btn btn-primary btn-customized-4 btn-customized-light" href="#" role="button">Light</a>
				</div> -->
			
			</nav>
			<!-- End sidebar -->
			
			<!-- Dark overlay -->
    		<div class="overlay"></div>

			<!-- Content -->
			<div class="content">
			
				<!-- open sidebar menu -->
				<a class="btn btn-primary btn-customized open-menu" href="#" role="button">
                    <i class="fas fa-align-left"></i> <span>Menu</span>
                </a>

		        <!-- Top content -->
		        <div class="top-content section-container" id="top-content">
			        <div class="container">
			            <div class="row">
                            <div class="col-md-3 section-5-box banner-logo">
                                <img alt="Logo" src="../_static/nidl.png">
                            </div>
			                <div class="col-md-7 section-5-box">
			                	<h1 class="wow fadeIn">    <p>Deep learning for NeuroImaging in Python.</p></h1>
			                </div>
			            </div>
			        </div>
		        </div>
                    
                    <div class="document">
                        <div class="admonition note">
<p class="admonition-title">Note</p>
<p>This page is a reference documentation. It only explains the class signature, and not how to use it. Please refer to the <a class="reference internal" href="../auto_gallery/index.html#sphx-glr-auto-gallery"><span class="std std-ref">gallery</span></a> for the big picture.</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="nidl.estimators.linear.LogisticRegression">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nidl.estimators.linear.</span></span><span class="sig-name descname"><span class="pre">LogisticRegression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nidl/estimators/linear/logistic_regression.html#LogisticRegression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nidl.estimators.linear.LogisticRegression" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="nidl.estimators.base.ClassifierMixin.html#nidl.estimators.base.ClassifierMixin" title="nidl.estimators.base.ClassifierMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClassifierMixin</span></code></a>, <a class="reference internal" href="nidl.estimators.base.BaseEstimator.html#nidl.estimators.base.BaseEstimator" title="nidl.estimators.base.BaseEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEstimator</span></code></a></p>
<p>LogisticRegression implementation.</p>
<p>This class can also be used in self supervised settings.
After we have trained our encoder via self supervised learning, we can
deploy it on downstream tasks and see how well it performs with little
data. A common setup, which also verifies whether the model has learned
generalized representations, is to perform Logistic Regression on the
features. In other words, we learn a MLP that maps the
representations to a class prediction. If very little data is available,
it might be beneficial to dynamically encode the images during training
so that we can also apply data augmentations. To freeze the input encoder,
consider using <a class="reference internal" href="#nidl.estimators.linear.LogisticRegression.freeze_encoder" title="nidl.estimators.linear.LogisticRegression.freeze_encoder"><code class="xref py py-meth docutils literal notranslate"><span class="pre">LogisticRegression.freeze_encoder()</span></code></a>. It assumes the
MLP layer is named <cite>fc</cite>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> : nn.Module</p>
<blockquote>
<div><p>the encoder f(.) architecture.</p>
</div></blockquote>
<p><strong>num_classes</strong> : int</p>
<blockquote>
<div><p>the number of class to predict.</p>
</div></blockquote>
<p><strong>lr</strong> : float</p>
<blockquote>
<div><p>the learning rate.</p>
</div></blockquote>
<p><strong>temperature</strong> : float</p>
<blockquote>
<div><p>the SimCLR loss temperature parameter.</p>
</div></blockquote>
<p><strong>weight_decay</strong> : float</p>
<blockquote>
<div><p>the Adam optimizer weight decay parameter.</p>
</div></blockquote>
<p><strong>max_epochs</strong> : int, default=None</p>
<blockquote>
<div><p>optionaly, use a MultiStepLR scheduler.</p>
</div></blockquote>
<p><strong>random_state</strong> : int, default=None</p>
<blockquote>
<div><p>setting a seed for reproducibility.</p>
</div></blockquote>
<p><strong>kwargs</strong> : dict</p>
<blockquote>
<div><p>Trainer parameters.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>A batch of data must contains two elements: a tensor with images, and a
tensor with the variable to predict.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s2">&quot;encoder&quot;</span><span class="p">,</span> <span class="n">encoder</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s2">&quot;fc&quot;</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">latent_size</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">]))</span>
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>model</p></td>
<td><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> containing the prediction model.</p></td>
</tr>
<tr class="row-even"><td><p>validation_step_outputs</p></td>
<td><p>a dictionnary with the validation predictions and associated labels in the ‘pred’, and ‘label’ keys, respectivelly.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="nidl.estimators.linear.LogisticRegression.configure_optimizers">
<span class="sig-name descname"><span class="pre">configure_optimizers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nidl/estimators/linear/logistic_regression.html#LogisticRegression.configure_optimizers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nidl.estimators.linear.LogisticRegression.configure_optimizers" title="Link to this definition">¶</a></dt>
<dd><p>Declare a <code class="xref py py-class docutils literal notranslate"><span class="pre">AdamW</span></code> optimizer and, optionnaly
(<code class="docutils literal notranslate"><span class="pre">max_epochs</span></code> is defined), a
<code class="xref py py-class docutils literal notranslate"><span class="pre">MultiStepLR</span></code> learning-rate
scheduler.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nidl.estimators.linear.LogisticRegression.cross_entropy_loss">
<span class="sig-name descname"><span class="pre">cross_entropy_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nidl/estimators/linear/logistic_regression.html#LogisticRegression.cross_entropy_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nidl.estimators.linear.LogisticRegression.cross_entropy_loss" title="Link to this definition">¶</a></dt>
<dd><p>Compute and log the InfoNCE loss using
<code class="xref py py-func docutils literal notranslate"><span class="pre">cross_entropy()</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nidl.estimators.linear.LogisticRegression.freeze_encoder">
<span class="sig-name descname"><span class="pre">freeze_encoder</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nidl/estimators/linear/logistic_regression.html#LogisticRegression.freeze_encoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nidl.estimators.linear.LogisticRegression.freeze_encoder" title="Link to this definition">¶</a></dt>
<dd><p>Freeze the input encoder. Useful for self supervised settings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nidl.estimators.linear.LogisticRegression.on_validation_epoch_end">
<span class="sig-name descname"><span class="pre">on_validation_epoch_end</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nidl/estimators/linear/logistic_regression.html#LogisticRegression.on_validation_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nidl.estimators.linear.LogisticRegression.on_validation_epoch_end" title="Link to this definition">¶</a></dt>
<dd><p>Clean the validation cache at each epoch ends.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nidl.estimators.linear.LogisticRegression.predict_step">
<span class="sig-name descname"><span class="pre">predict_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nidl/estimators/linear/logistic_regression.html#LogisticRegression.predict_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nidl.estimators.linear.LogisticRegression.predict_step" title="Link to this definition">¶</a></dt>
<dd><p>Step function called during
<code class="xref py py-meth docutils literal notranslate"><span class="pre">predict()</span></code>. By default,
it calls <code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code>.
Override to add any processing logic.</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">predict_step()</span></code> is
used to scale inference on multi-devices.</p>
<p>To prevent an OOM error, it is possible to use
<code class="xref py py-class docutils literal notranslate"><span class="pre">BasePredictionWriter</span></code>
callback to write the predictions to disk or database after each
batch or on epoch end.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">BasePredictionWriter</span></code> should
be used while using a spawn based accelerator. This happens for
training strategy <code class="docutils literal notranslate"><span class="pre">strategy=&quot;ddp_spawn&quot;</span></code> or training on 8 TPU cores
with <code class="docutils literal notranslate"><span class="pre">accelerator=&quot;tpu&quot;,</span> <span class="pre">devices=8</span></code> as predictions won’t be returned.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> : iterable, normally a <code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></p>
<blockquote>
<div><p>the current data.</p>
</div></blockquote>
<p><strong>batch_idx</strong> : int</p>
<blockquote>
<div><p>the index of this batch.</p>
</div></blockquote>
<p><strong>dataloader_idx</strong> : int, default=0</p>
<blockquote>
<div><p>the index of the dataloader that produced this batch (only if
multiple dataloaders are used).</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> : Any</p>
<blockquote>
<div><p>the predicted output.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nidl.estimators.linear.LogisticRegression.training_step">
<span class="sig-name descname"><span class="pre">training_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nidl/estimators/linear/logistic_regression.html#LogisticRegression.training_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nidl.estimators.linear.LogisticRegression.training_step" title="Link to this definition">¶</a></dt>
<dd><p>Here you compute and return the training loss and some additional
metrics for e.g. the progress bar or logger.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> : iterable, normally a <code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></p>
<blockquote>
<div><p>the current data.</p>
</div></blockquote>
<p><strong>batch_idx</strong> : int</p>
<blockquote>
<div><p>the index of this batch.</p>
</div></blockquote>
<p><strong>dataloader_idx</strong> : int, default=0</p>
<blockquote>
<div><p>the index of the dataloader that produced this batch (only if
multiple dataloaders are used).</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>loss</strong> : STEP_OUTPUT</p>
<blockquote>
<div><p>the computed loss:</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code> - the loss tensor.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dict</span></code> - a dictionary which can include any keys, but must
include the key <code class="docutils literal notranslate"><span class="pre">'loss'</span></code> in the case of automatic optimization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> - in automatic optimization, this will skip to the
next batch (but is not supported for multi-GPU, TPU, or
DeepSpeed). For manual optimization, this has no special
meaning, as returning the loss is not required.</p></li>
</ul>
</div></blockquote>
<p>To use multiple optimizers, you can switch to ‘manual optimization’</p>
<p>and control their stepping:</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>When <code class="docutils literal notranslate"><span class="pre">accumulate_grad_batches</span></code> &gt; 1, the loss returned here will be
automatically normalized by <code class="docutils literal notranslate"><span class="pre">accumulate_grad_batches</span></code> internally.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="bp">self</span><span class="o">.</span><span class="n">automatic_optimization</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Multiple optimizers (e.g.: GANs)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">training_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">opt1</span><span class="p">,</span> <span class="n">opt2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimizers</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># do training_step with encoder</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">opt1</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># do training_step with decoder</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">opt2</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nidl.estimators.linear.LogisticRegression.validation_step">
<span class="sig-name descname"><span class="pre">validation_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/nidl/estimators/linear/logistic_regression.html#LogisticRegression.validation_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#nidl.estimators.linear.LogisticRegression.validation_step" title="Link to this definition">¶</a></dt>
<dd><p>Operates on a single batch of data from the validation set. In
this step you’d might generate examples or calculate anything of
interest like accuracy.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch</strong> : iterable, normally a <code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></p>
<blockquote>
<div><p>the current data.</p>
</div></blockquote>
<p><strong>batch_idx</strong> : int</p>
<blockquote>
<div><p>the index of this batch.</p>
</div></blockquote>
<p><strong>dataloader_idx</strong> : int, default=0</p>
<blockquote>
<div><p>the index of the dataloader that produced this batch (only if
multiple dataloaders are used).</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>loss</strong> : STEP_OUTPUT</p>
<blockquote>
<div><p>the computed loss:</p>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code> - the loss tensor.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dict</span></code> - a dictionary. can include any keys, but must include
the key <code class="docutils literal notranslate"><span class="pre">'loss'</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> - skip to the next batch.</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>When the <a class="reference internal" href="#nidl.estimators.linear.LogisticRegression.validation_step" title="nidl.estimators.linear.LogisticRegression.validation_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">validation_step()</span></code></a> is called, the model has been put in
eval mode and PyTorch gradients have been disabled. At the end of
validation,  the model goes back to training mode and gradients are
enabled.</p>
</dd></dl>

</dd></dl>

<section id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h1><div class='divider-1 wow fadeInUp' style='margin-top: -20px;'><span></span></div>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer section-5-box wow fadeInUp" tooltip="From: https://uvadlc-notebooks.readthedocs.io"><img alt="" src="../_images/sphx_glr_simclr_stl10_thumb.png" />
<p><a class="reference internal" href="../auto_gallery/simclr_stl10.html#sphx-glr-auto-gallery-simclr-stl10-py"><span class="std std-ref">Self-Supervised Contrastive Learning with SimCLR</span></a></p>
  <div class="sphx-glr-thumbnail-title">Self-Supervised Contrastive Learning with SimCLR</div>
</div></div></section>

                    </div>
                <div class="spacer"></div>
		        
		        <!-- Footer -->
		        <div class="section-6-container section-container section-container-image-bg" id="section-6">
			        <div class="container">
			            <div class="row">
		                    <div class="col-md-5 offset-md-1 section-6-box wow fadeInDown">
                                <div class="section-6-title">
		                    	    <p>Follow us</p>
                                </div>
		                    	<div class="section-6-social">
			                    	<a href="https://www.facebook.com/pages/NeuroSpin/171075046414933"><i class="fab fa-facebook-f"></i></a>
									<a href="https://www.youtube.com/CEASaclay"><i class="fab fa-youtube"></i></a>
									<a href="https://twitter.com/neurospin_91"><i class="fab fa-twitter"></i></a>
									<a href="https://gaia.neurospin.fr"><i class="fa fa-link"></i></a>
                                    <p>&copy; 2025, 
nidl developers
 <antoine.grigis@cea.fr></p>
		                    	</div>
		                    </div>
			            </div>
			        </div>
                </div>
	        
	        </div>
	        <!-- End content -->
        
        </div>
        <!-- End wrapper -->

        <!-- Javascript -->
		<script src="../_static/js/jquery-3.3.1.min.js"></script>
		<script src="../_static/js/jquery-migrate-3.0.0.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
        <script src="../_static/js/jquery.backstretch.min.js"></script>
        <script src="../_static/js/wow.min.js"></script>
        <script src="../_static/js/jquery.waypoints.min.js"></script>
        <script src="../_static/js/jquery.mCustomScrollbar.concat.min.js"></script>
        <script src="../_static/js/scripts.js"></script>
        <script src="../_static/js/jquery.mosaic.js"></script>
        <script src="../_static/js/search.js"></script>
        <script type="text/javascript">
	        $('.top-content').backstretch("../_static/img/backgrounds/banner1.png");
            $('.section-6-container').backstretch("../_static/img/backgrounds/footer1.png");
        </script>

    </body>

</html>